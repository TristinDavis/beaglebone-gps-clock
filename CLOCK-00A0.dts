/dts-v1/;
/plugin/;

#include <dt-bindings/board/am335x-bbw-bbb-base.h>
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/pinctrl/am33xx.h>

/ {
	compatible = "ti,beaglebone", "ti,beaglebone-black", "ti,beaglebone-green";

	/* identification */
	part-number = "CLOCK";
	version = "00A0";

	exclusive-use = "P9.11", "P9.13", "P9.15", "uart4", "P9.17", "P9.18", "P9.21", "P9.22", "spi0";


	fragment@0 {
		target = <&ocp>;
		__overlay__ {
                        P9_11_pinmux { status = "disabled"; };
			P9_13_pinmux { status = "disabled"; };
    			P9_15_pinmux { status = "disabled"; };

                        P9_17_pinmux { status = "disabled"; };
                        P9_18_pinmux { status = "disabled"; };
                        P9_21_pinmux { status = "disabled"; };
                        P9_22_pinmux { status = "disabled"; };
		};
	};

	fragment@1 {
		target = <&am33xx_pinmux>;
		__overlay__ {
                        bb_uart4_pins: pinmux_bb_uart4_pins {
                                pinctrl-single,pins = <
                                	BONE_P9_13 (PIN_OUTPUT | MUX_MODE6)
                                        BONE_P9_11 (PIN_INPUT | MUX_MODE6)
                                >;
                        };

                        bb_pps_pins: pinmux_bb_pps_pins {
                                pinctrl-single,pins = <
                                        BONE_P9_15 (PIN_INPUT_PULLDOWN | MUX_MODE7)
                                >;
                        };

                        bb_spi0_pins: pinmux_bb_spi0_pins {
                                pinctrl-single,pins = <
                                        BONE_P9_22 (PIN_INPUT_PULLUP | MUX_MODE0)
                                        BONE_P9_21 (PIN_INPUT_PULLUP | MUX_MODE0)
                                        BONE_P9_18 (PIN_OUTPUT_PULLUP | MUX_MODE0) 
                                        BONE_P9_17 (PIN_OUTPUT_PULLUP | MUX_MODE0)
                                >;
                        };
		};
	};

        fragment@2 {
                target = <&uart4>;
                __overlay__ {
                        status = "okay";
                        pinctrl-names = "default";
                        pinctrl-0 = <&bb_uart4_pins>;
               };
        };

        fragment@3 {
                target = <&ocp>;
                __overlay__ {
		        pps {
                                status = "okay";
                                compatible = "pps-gpio";
                                pinctrl-names = "default";
                                pinctrl-0 = <&bb_pps_pins>;
                                gpios = <&gpio1 16 0>;
                        };
                };
        };

        fragment@4 {
                target = <&spi0>;
                __overlay__ {
                        #address-cells = <1>;
                        #size-cells = <0>;
                        status = "okay";
                        pinctrl-names = "default";
                        pinctrl-0 = <&bb_spi0_pins>;

			display@0 {
			        status = "okay";
				compatible = "spidev";
				spi-max-frequency = <10000000>;
				reg = <0>;
	                };
		};
        };
};
